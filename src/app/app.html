<app-loading />

@if (showLayout()) {
  <nz-layout class="app-layout">
    <nz-sider
      class="app-layout-sidebar app-layout-left"
      nzCollapsible
      [nzWidth]="248"
      [nzCollapsedWidth]="48"
      nzBreakbreakpoint="md"
      [nzCollapsed]="isSiderCollapsedSig()"
      (nzCollapsedChange)="storeService.setSiderCollapsed($event)"
      [nzTrigger]="null"
    >
      <app-sider class="app-layout-sider-inner">
        <app-sider-header 
          class="app-layout-sider-header"
          [isSiderCollapsed]="isSiderCollapsedSig()"
        />
        <app-sider-menu 
          class="app-layout-sider-content" 
          [layoutConfig]="layoutConfigSig()"
        />
        <app-sider-footer 
          class="app-layout-sider-footer" 
          [layoutConfig]="layoutConfigSig()"
          [isSiderCollapsed]="isSiderCollapsedSig()"
        />
      </app-sider>
    </nz-sider>

    <!-- 折叠按钮放在侧边栏外部，定位在侧边栏右侧 -->
    <app-collapse-button />

    <nz-layout class="app-layout-right">
      <nz-header class="app-layout-header">
        <div class="header-left">
          <app-module-selector />
        </div>
        <div class="header-right">
          <app-search />
          <app-lang-selector />
          @if (isAuthenticatedSig() && userSig(); as user) {
            <app-user-info (onLogout)="storeService.logout()" />
          }
        </div>
      </nz-header>
      <nz-content class="app-layout-content">
        <router-outlet></router-outlet>
      </nz-content>
      <nz-footer class="app-layout-footer">
        <p>footer</p>
      </nz-footer>
    </nz-layout>
  </nz-layout>
} @else {
  <router-outlet></router-outlet>
}
